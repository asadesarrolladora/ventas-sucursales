<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel Admin - Inventarios</title>
    <link rel="stylesheet" href="css/estilos.css"> </head>
<body>
    <header style="background: #2196F3; color: white; padding: 20px; text-align: center;">
        <h1>GestiÃ³n de Inventario</h1>
    </header>

    <div style="display: flex; padding: 20px; gap: 20px;">
        <div style="flex: 1; border: 1px solid #ddd; padding: 20px; border-radius: 8px;">
            <h3>âœ¨ Nuevo Producto</h3>
            <form id="formProducto">
                <label>Nombre del Producto</label><br>
                <input type="text" name="nombre" id="nombre" placeholder="Ej: Sabritas" required style="width: 100%; margin-bottom: 10px;"><br>
                
                <label>Precio al PÃºblico</label><br>
                <input type="number" step="0.01" name="precio" id="precio" placeholder="0.00" required style="width: 100%; margin-bottom: 10px;"><br>
                
                <label>Stock Inicial</label><br>
                <input type="number" name="stock" id="stock" value="0" min="0" required style="width: 100%; margin-bottom: 20px;"><br>
                
                <button type="submit" style="background: #2e7d32; color: white; border: none; padding: 10px; width: 100%; cursor: pointer;">Guardar Producto</button>
            </form>
        </div>

        <div style="flex: 2; border: 1px solid #ddd; padding: 20px; border-radius: 8px;">
            <h3>ðŸ“¦ Inventario Global</h3>
            <table border="1" style="width: 100%; border-collapse: collapse; text-align: left;">
                <thead>
                    <tr style="background: #eee;">
                        <th>ID</th>
                        <th>Producto</th>
                        <th>Stock Actual</th>
                    </tr>
                </thead>
                <tbody id="tablaInventario">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        // Cargar inventario al iniciar
        function cargarInventario() {
            fetch('api/ver_inventario_completo.php')
                .then(res => res.json())
                .then(data => {
                    const tabla = document.getElementById('tablaInventario');
                    tabla.innerHTML = data.map(p => `
                        <tr>
                            <td>${p.id_producto}</td>
                            <td>${p.nombre}</td>
                            <td style="color: ${p.cantidad_disponible <= 0 ? 'red' : 'green'}">
                                ${p.cantidad_disponible} unidades
                            </td>
                        </tr>
                    `).join('');
                });
        }

        // Guardar producto
        document.getElementById('formProducto').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            
            fetch('api/admin_productos.php', {
                method: 'POST',
                body: formData
            })
            .then(res => res.text())
            .then(msg => {
                alert(msg);
                this.reset();
                cargarInventario();
            });
        });

        cargarInventario();
    </script>
</body>
</html>